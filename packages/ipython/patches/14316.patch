From 1fa6a775688f4f4df82da8dd488763b48798e2c1 Mon Sep 17 00:00:00 2001
From: Hood Chatham <roberthoodchatham@gmail.com>
Date: Wed, 31 Jan 2024 10:15:36 -0800
Subject: [PATCH 1/3] IPython/utils/_process_emscripten.py: New

This is https://github.com/ipython/ipython/pull/14316

---
 IPython/utils/_process_emscripten.py | 12 ++++++++++++
 IPython/utils/process.py             |  2 ++
 2 files changed, 14 insertions(+)
 create mode 100644 IPython/utils/_process_emscripten.py

diff --git a/IPython/utils/_process_emscripten.py b/IPython/utils/_process_emscripten.py
new file mode 100644
index 00000000000..6853dc12f6a
--- /dev/null
+++ b/IPython/utils/_process_emscripten.py
@@ -0,0 +1,12 @@
+def system(cmd):
+    raise OSError("Not available")
+
+def getoutput(cmd):
+    raise OSError("Not available")
+
+def check_pid(cmd):
+    raise OSError("Not available")
+
+def arg_split(s, posix=False, strict=True):
+    """This one could be made to work but it's not clear if it would be useful..."""
+    raise OSError("Not available")
diff --git a/IPython/utils/process.py b/IPython/utils/process.py
index 489b7c13d0c..f50cf9ba223 100644
--- a/IPython/utils/process.py
+++ b/IPython/utils/process.py
@@ -15,6 +15,8 @@
     from ._process_win32 import system, getoutput, arg_split, check_pid
 elif sys.platform == 'cli':
     from ._process_cli import system, getoutput, arg_split, check_pid
+elif sys.platform == "emscripten":
+    from ._process_emscripten import system, getoutput, arg_split, check_pid
 else:
     from ._process_posix import system, getoutput, arg_split, check_pid
 

From f9ae3ba85299e51302db756c676f9add3c6651b9 Mon Sep 17 00:00:00 2001
From: Matthias Koeppe <mkoeppe@math.ucdavis.edu>
Date: Wed, 31 Jan 2024 10:22:02 -0800
Subject: [PATCH 2/3] setup.cfg (install_requires) [emscripten]: Do not require
 pexpect

---
 setup.cfg | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/setup.cfg b/setup.cfg
index 31606a879bf..de77754fcaa 100644
--- a/setup.cfg
+++ b/setup.cfg
@@ -34,7 +34,7 @@ install_requires =
     exceptiongroup; python_version<'3.11'
     jedi>=0.16
     matplotlib-inline
-    pexpect>4.3; sys_platform != "win32"
+    pexpect>4.3; sys_platform != "win32" and sys_platform != "emscripten"
     prompt_toolkit>=3.0.41,<3.1.0
     pygments>=2.4.0
     stack_data

From b9ea837d0430374cefb2b3902e5aaf316a4beefb Mon Sep 17 00:00:00 2001
From: Matthias Koeppe <mkoeppe@math.ucdavis.edu>
Date: Wed, 31 Jan 2024 10:25:12 -0800
Subject: [PATCH 3/3] IPython/utils/_process_emscripten.py: Add file header

---
 IPython/utils/_process_emscripten.py | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/IPython/utils/_process_emscripten.py b/IPython/utils/_process_emscripten.py
index 6853dc12f6a..cbab32d9f07 100644
--- a/IPython/utils/_process_emscripten.py
+++ b/IPython/utils/_process_emscripten.py
@@ -1,3 +1,8 @@
+"""Emscripten-specific implementation of process utilities.
+
+This file is only meant to be imported by process.py, not by end-users.
+"""
+
 def system(cmd):
     raise OSError("Not available")
 
